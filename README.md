# –ó–∞—á–µ–º

–í—Å–µ –ø—Ä–æ—Å—Ç–æ - –∑–∞–¥–∞—á–∞ - –≤–µ—Å—Ç–∏ —É—á–µ—Ç —Å—Ä–µ–¥—Å—Ç–≤ –ø–æ–ª—É—á–∞–µ–º—ã—Ö –æ—Ç —Ä–æ–¥–∏—Ç–µ–ª–µ–π, serverless, zero-infrastructure –∏ –≤–æ—Ç —ç—Ç–æ –≤—Å—ë...
–ö–ª–∏–µ–Ω—Ç—ã —É –≤—Å–µ—Ö –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞—Ö –µ—Å—Ç—å, —É—á–µ—Ç–∫–∏ –≥—É–≥–ª–æ–≤—ã–µ —Ç–æ–∂–µ... —Ç–∞–∫ —á—Ç–æ...

# –£—á—ë—Ç —Å–±–æ—Ä–æ–≤/–≤–∑–Ω–æ—Å–æ–≤ –≤ Google Sheets (Google Apps Script)

**–í–µ—Ä—Å–∏—è: 2.0 (–±–∞–ª–∞–Ω—Å–æ–≤–∞—è –º–æ–¥–µ–ª—å)**

–ü—Ä–æ—Å—Ç–æ–π –∏ –±—ã—Å—Ç—Ä—ã–π —É—á—ë—Ç –ø–ª–∞—Ç–µ–∂–µ–π –¥–ª—è –∫–ª–∞—Å—Å–∞/–≥—Ä—É–ø–ø—ã –ø—Ä—è–º–æ –≤ Google –¢–∞–±–ª–∏—Ü–∞—Ö. –û–¥–Ω–∞ —Å–µ–º—å—è = –æ–¥–∏–Ω —Ä–µ–±—ë–Ω–æ–∫. –í—Å–µ —Ä–∞—Å—á—ë—Ç—ã –º–æ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ.

---

## üöÄ –ß—Ç–æ –Ω–æ–≤–æ–≥–æ –≤ v2.0

- **–ë–∞–ª–∞–Ω—Å–æ–≤–∞—è –º–æ–¥–µ–ª—å**: –ø–ª–∞—Ç–µ–∂–∏ –ø–æ–ø–æ–ª–Ω—è—é—Ç –±–∞–ª–∞–Ω—Å —Å–µ–º—å–∏, —Ü–µ–ª–∏ —Å–ø–∏—Å—ã–≤–∞—é—Ç —Å –±–∞–ª–∞–Ω—Å–∞
- **–°–≤–æ–±–æ–¥–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏**: –º–æ–∂–Ω–æ –≤–Ω–æ—Å–∏—Ç—å —Å—Ä–µ–¥—Å—Ç–≤–∞ –±–µ–∑ –ø—Ä–∏–≤—è–∑–∫–∏ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ü–µ–ª–∏
- **–†–µ–≥—É–ª—è—Ä–Ω—ã–µ —Ü–µ–ª–∏**: –µ–∂–µ–º–µ—Å—è—á–Ω—ã–µ/–µ–∂–µ–∫–≤–∞—Ä—Ç–∞–ª—å–Ω—ã–µ —Å–±–æ—Ä—ã —Å –∞–≤—Ç–æ—Å–æ–∑–¥–∞–Ω–∏–µ–º
- **–ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–ª–∞–Ω—Å–∞**: –í–Ω–µ—Å–µ–Ω–æ ‚Üí –°–ø–∏—Å–∞–Ω–æ ‚Üí –†–µ–∑–µ—Ä–≤ ‚Üí –°–≤–æ–±–æ–¥–Ω–æ ‚Üí –î–æ–ª–≥
- **–†–µ–∂–∏–º voluntary**: –¥–æ–±—Ä–æ–≤–æ–ª—å–Ω—ã–µ –≤–∑–Ω–æ—Å—ã –±–µ–∑ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –¥–æ–ª–≥–∞
- **–¢–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏—è**: `collection_id` ‚Üí `goal_id`, ¬´–°–±–æ—Ä—ã¬ª ‚Üí ¬´–¶–µ–ª–∏¬ª
- **–ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: –∫–æ–¥ —Ä–∞–∑–±–∏—Ç –Ω–∞ 23 –º–æ–¥—É–ª—è –≤ `src/`

–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏: [docs/TZ-v2.md](docs/TZ-v2.md) | –ü–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏: [docs/MIGRATION-PLAN.md](docs/MIGRATION-PLAN.md)

### –ú–∏–≥—Ä–∞—Ü–∏—è —Å v1.x
–î–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ç–∞–±–ª–∏—Ü: **Funds ‚Üí Migrate to v2.0**. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –°–æ–∑–¥–∞—ë—Ç—Å—è –±—ç–∫–∞–ø
- ¬´–°–±–æ—Ä—ã¬ª –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞–µ—Ç—Å—è –≤ ¬´–¶–µ–ª–∏¬ª
- `collection_id` ‚Üí `goal_id` (C001 ‚Üí G001)
- –û–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∏ —Ñ–æ—Ä–º—É–ª—ã

---

## –¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è 2.0

### –¢—Ä–∏ –±–∞–∑–æ–≤—ã—Ö –ª–∏—Å—Ç–∞ = 90% —É—Å–ø–µ—Ö–∞
- **–°–µ–º—å–∏** ‚Äî —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Å–µ–º–µ–π/–∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –∏ –ø—Ä–∏–∑–Ω–∞–∫ ¬´–ê–∫—Ç–∏–≤–µ–Ω¬ª. –ò–º–µ–Ω–Ω–æ –æ—Ç—Å—é–¥–∞ –±–µ—Ä—É—Ç—Å—è —É—á–∞—Å—Ç–Ω–∏–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.
- **–¶–µ–ª–∏** ‚Äî —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ü–µ–ª–µ–π/—Å–±–æ—Ä–æ–≤: —Ç–∏–ø (—Ä–∞–∑–æ–≤–∞—è/—Ä–µ–≥—É–ª—è—Ä–Ω–∞—è), —Ä–µ–∂–∏–º –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è, —Å—É–º–º–∞/–ø–∞—Ä–∞–º–µ—Ç—Ä—ã, —Å—Ç–∞—Ç—É—Å.
- **–ü–ª–∞—Ç–µ–∂–∏** ‚Äî –≤—Å–µ –≤—Ö–æ–¥—è—â–∏–µ –ø–ª–∞—Ç–µ–∂–∏ —Å –≤—ã–±–æ—Ä–æ–º —Å–µ–º—å–∏ –∏ —Ü–µ–ª–∏ –ø–æ –º–µ—Ç–∫–µ ¬´–ù–∞–∑–≤–∞–Ω–∏–µ (ID)¬ª; —Å—É–º–º–∞ > 0. –¶–µ–ª—å –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞ (—Å–≤–æ–±–æ–¥–Ω—ã–π –ø–ª–∞—Ç—ë–∂).

–í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ª–∏—Å—Ç—ã –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –∏ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ —ç—Ç–∏—Ö —Ç—Ä—ë—Ö: ¬´–ë–∞–ª–∞–Ω—Å¬ª, ¬´–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è¬ª, ¬´–°–≤–æ–¥–∫–∞¬ª, ¬´Lists¬ª (—Å–∫—Ä—ã—Ç—ã–π), ¬´–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è¬ª, ¬´–í—ã–¥–∞—á–∞¬ª (–∂—É—Ä–Ω–∞–ª –≤—Ä—É—á–µ–Ω–∏–π), ¬´–°—Ç–∞—Ç—É—Å –≤—ã–¥–∞—á–∏¬ª (–¥–∞—à–±–æ—Ä–¥). –õ–∏—Å—Ç ¬´–£—á–∞—Å—Ç–∏–µ¬ª ‚Äî –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä —É—á–∞—Å—Ç–∏—è (—Å–º. –Ω–∏–∂–µ); –µ—Å–ª–∏ –æ–Ω –ø—É—Å—Ç, —É—á–∞—Å—Ç–≤—É—é—Ç –≤—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–µ–º—å–∏.

## –ß—Ç–æ —É–º–µ–µ—Ç
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ª–∏—Å—Ç–æ–≤: –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è, –°–µ–º—å–∏, –¶–µ–ª–∏, –£—á–∞—Å—Ç–∏–µ, –ü–ª–∞—Ç–µ–∂–∏, –ë–∞–ª–∞–Ω—Å, –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è, –°–≤–æ–¥–∫–∞, –í—ã–¥–∞—á–∞, –°—Ç–∞—Ç—É—Å –≤—ã–¥–∞—á–∏, Lists (—Å–∫—Ä—ã—Ç—ã–π)
- –í—ã–ø–∞–¥–∞—é—â–∏–µ —Å–ø–∏—Å–∫–∏ —Å –º–µ—Ç–∫–∞–º–∏ ¬´–ù–∞–∑–≤–∞–Ω–∏–µ (ID)¬ª, –ª–æ–≥–∏–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç ID
- **7 —Ä–µ–∂–∏–º–æ–≤ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è:**
  - `static_per_family` ‚Äî —Ñ–∏–∫—Å –Ω–∞ —Å–µ–º—å—é
  - `shared_total_all` ‚Äî –æ–±—â–∞—è —Å—É–º–º–∞ T –¥–µ–ª–∏—Ç—Å—è –Ω–∞ N —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
  - `shared_total_by_payers` ‚Äî –æ–±—â–∞—è —Å—É–º–º–∞ T –¥–µ–ª–∏—Ç—Å—è –ø–æ—Ä–æ–≤–Ω—É –º–µ–∂–¥—É –æ–ø–ª–∞—Ç–∏–≤—à–∏–º–∏ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏ (K –ø–ª–∞—Ç–∏–≤—à–∏—Ö)
  - `dynamic_by_payers` ‚Äî —Ü–µ–ª—å T —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Å—Ä–µ–¥–∏ –ø–ª–∞—Ç–∏–≤—à–∏—Ö —á–µ—Ä–µ–∑ cap x (water-filling): Œ£ min(P_i, x) = min(T, Œ£P_i)
  - `proportional_by_payers` ‚Äî —Ü–µ–ª—å T —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –≤–∑–Ω–æ—Å–∞–º –ø–ª–∞—Ç–∏–≤—à–∏—Ö: –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ i = T ¬∑ P_i / Œ£P
  - `unit_price` ‚Äî –ø–æ—à—Ç—É—á–Ω–∞—è –ø–æ–∫—É–ø–∫–∞ –ø–æ —Ü–µ–Ω–µ x (–∏–∑ ¬´–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π x¬ª): –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ i = floor(P_i/x)¬∑x (–ø–æ–ª–Ω—ã–µ –µ–¥–∏–Ω–∏—Ü—ã)
  - `voluntary` ‚Äî –¥–æ–±—Ä–æ–≤–æ–ª—å–Ω—ã–π –≤–∑–Ω–æ—Å: —Å–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è —Ä–æ–≤–Ω–æ —Å—Ç–æ–ª—å–∫–æ, —Å–∫–æ–ª—å–∫–æ –≤–Ω–µ—Å–µ–Ω–æ (–±–µ–∑ –¥–æ–ª–≥–∞)
- –£—á–∞—Å—Ç–∏–µ: –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–µ–º—å–∏; ¬´–£—á–∞—Å—Ç–≤—É–µ—Ç¬ª —Å—É–∂–∞–µ—Ç, ¬´–ù–µ —É—á–∞—Å—Ç–≤—É–µ—Ç¬ª –∏—Å–∫–ª—é—á–∞–µ—Ç
- **–ë–∞–ª–∞–Ω—Å v2.0**: –í–Ω–µ—Å–µ–Ω–æ –≤—Å–µ–≥–æ, –°–ø–∏—Å–∞–Ω–æ –≤—Å–µ–≥–æ, –ó–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–æ, –°–≤–æ–±–æ–¥–Ω—ã–π –æ—Å—Ç–∞—Ç–æ–∫, –ó–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç—å
- –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è: –ø–æ–º–µ—Ç–∫–∞ –ø–æ –∫–∞–∂–¥–æ–π –ø–∞—Ä–µ —Å–µ–º—å—è‚Üî—Ü–µ–ª—å (–æ–ø–ª–∞—á–µ–Ω–æ, –Ω–∞—á–∏—Å–ª–µ–Ω–æ, —Ä–∞–∑–Ω–æ—Å—Ç—å, —Ä–µ–∂–∏–º)
- –°–≤–æ–¥–∫–∞: –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è —Ç–∞–±–ª–∏—Ü–∞ –ø–æ —Ü–µ–ª—è–º (—Å—É–º–º–∞, —Å–æ–±—Ä–∞–Ω–æ, —É—á–∞—Å—Ç–Ω–∏–∫–∏, –ø–ª–∞—Ç–µ–ª—å—â–∏–∫–∏, –µ—â—ë –ø–ª–∞—Ç–µ–ª—å—â–∏–∫–æ–≤ –¥–æ –∑–∞–∫—Ä—ã—Ç–∏—è, –æ—Å—Ç–∞—Ç–æ–∫)
- –ú–µ–Ω—é Funds: Setup, Rebuild validations, Recalculate (Balance & Detail), Generate IDs, Close Goal, Load Sample Data, Migrate to v2.0
- –°—Ç–∞–π–ª–∏–Ω–≥, –∑–∞–º–µ—Ç–∫–∏ –∫ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º (hover), –≤–∞–ª–∏–¥–∞—Ü–∏–∏, –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
1) –û—Ç–∫—Ä–æ–π—Ç–µ –ø—É—Å—Ç—É—é Google –¢–∞–±–ª–∏—Ü—É ‚Üí –†–∞—Å—à–∏—Ä–µ–Ω–∏—è ‚Üí Apps Script ‚Üí –≤—Å—Ç–∞–≤—å—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ `Code.gs` ‚Üí —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ.
2) –í —Ç–∞–±–ª–∏—Ü–µ: –º–µ–Ω—é Funds ‚Üí Setup / Rebuild structure.
3) –ó–∞–ø–æ–ª–Ω–∏—Ç–µ ¬´–°–µ–º—å–∏¬ª (–ê–∫—Ç–∏–≤–µ–Ω=–î–∞). –°–æ–∑–¥–∞–π—Ç–µ ¬´–¶–µ–ª–∏¬ª (–°—Ç–∞—Ç—É—Å=–û—Ç–∫—Ä—ã—Ç–∞, —Ä–µ–∂–∏–º, —Å—É–º–º–∞, –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ ‚Äî ¬´–°—Å—ã–ª–∫–∞ –Ω–∞ –≥—É–≥–ª–¥–∏—Å–∫¬ª).
4) –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ ¬´–£—á–∞—Å—Ç–∏–µ¬ª.
5) –í–Ω–æ—Å–∏—Ç–µ ¬´–ü–ª–∞—Ç–µ–∂–∏¬ª —á–µ—Ä–µ–∑ –≤—ã–ø–∞–¥–∞—é—â–∏–µ ¬´–ù–∞–∑–≤–∞–Ω–∏–µ (ID)¬ª. –°—É–º–º–∞ > 0. –¶–µ–ª—å –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞ (—Å–≤–æ–±–æ–¥–Ω—ã–π –ø–ª–∞—Ç—ë–∂).
6) –°–º–æ—Ç—Ä–∏—Ç–µ ¬´–ë–∞–ª–∞–Ω—Å¬ª –∏ ¬´–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è¬ª. –î–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö —Ü–µ–ª–µ–π –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Close Goal –¥–ª—è —Ñ–∏–∫—Å–∞—Ü–∏–∏ x.
7) –°–º–æ—Ç—Ä–∏—Ç–µ ¬´–°–≤–æ–¥–∫–∞¬ª ‚Äî –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω—ã–µ –∏—Ç–æ–≥–∏ –ø–æ –∫–∞–∂–¥–æ–π —Ü–µ–ª–∏ (—Å—É–º–º–∞, —Å–æ–±—Ä–∞–Ω–æ, —É—á–∞—Å—Ç–∏–µ, –æ—Ü–µ–Ω–∫–∞ –¥–æ–≤–æ—Ä–æ—Ç–∞).

‚ñ∂ –í—ã–¥–∞—á–∞ –µ–¥–∏–Ω–∏—Ü (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è –ø–æ—à—Ç—É—á–Ω—ã—Ö —Å–±–æ—Ä–æ–≤)
8) –í ¬´–°–±–æ—Ä—ã¬ª —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ ¬´–ö –≤—ã–¥–∞—á–µ –¥–µ—Ç—è–º¬ª = –î–∞ –∏ —Ä–µ–∂–∏–º –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è = unit_price_by_payers. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ ¬´–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π x¬ª –∑–∞–¥–∞–Ω –∫–∞–∫ —Ü–µ–Ω–∞ –∑–∞ –µ–¥–∏–Ω–∏—Ü—É (> 0).
9) –í–Ω–æ—Å–∏—Ç–µ –≤—Ä—É—á–µ–Ω–∏—è –Ω–∞ –ª–∏—Å—Ç–µ ¬´–í—ã–¥–∞—á–∞¬ª: —É–∫–∞–∂–∏—Ç–µ –¥–∞—Ç—É (—Å–ø—Ä–∞–≤–æ—á–Ω–æ), —Å–±–æ—Ä –∏ —Å–µ–º—å—é –ø–æ –º–µ—Ç–∫–∞–º ¬´–ù–∞–∑–≤–∞–Ω–∏–µ (ID)¬ª, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ ¬´–ï–¥–∏–Ω–∏—Ü¬ª (> 0), ¬´–ö—Ç–æ –≤—ã–¥–∞–ª¬ª (—Ç–µ–∫—Å—Ç), ¬´–í—ã–¥–∞–Ω–æ¬ª = –î–∞/–ù–µ—Ç.
10) –û—Ç–∫—Ä–æ–π—Ç–µ ¬´–°—Ç–∞—Ç—É—Å –≤—ã–¥–∞—á–∏¬ª ‚Äî –æ–Ω –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏: —Å–∫–æ–ª—å–∫–æ –µ–¥–∏–Ω–∏—Ü —Ç—Ä–µ–±—É–µ—Ç—Å—è (ceil(T/x)), –æ–ø–ª–∞—á–µ–Ω–æ (‚åä—Å–æ–±—Ä–∞–Ω–æ/x‚åã), –≤—ã–¥–∞–Ω–æ (—Å—É–º–º–∞ ¬´–ï–¥–∏–Ω–∏—Ü¬ª —Å –í—ã–¥–∞–Ω–æ=–î–∞), –∏ –æ—Å—Ç–∞—Ç–æ–∫ –∫ –≤—ã–¥–∞—á–µ.

### –ü–æ—Ä—è–¥–æ–∫ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
1) **–°–µ–º—å–∏** ‚Äî –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –∫–∞—Ä—Ç–æ—á–∫–∏ —Å–µ–º–µ–π. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É —Å—Ç—Ä–æ–∫ –ø–æ—è–≤–∏–ª–∏—Å—å ID (–∫–æ–ª–æ–Ω–∫–∞ family_id). –ï—Å–ª–∏ –ø—É—Å—Ç–æ, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Funds ‚Üí Generate IDs (all sheets).
2) **–¶–µ–ª–∏** ‚Äî –¥–æ–±–∞–≤—å—Ç–µ –Ω—É–∂–Ω—ã–µ —Ü–µ–ª–∏. –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø (—Ä–∞–∑–æ–≤–∞—è/—Ä–µ–≥—É–ª—è—Ä–Ω–∞—è), —Ä–µ–∂–∏–º –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ —Å—É–º–º—ã/–ø–∞—Ä–∞–º–µ—Ç—Ä—ã. –°—Ç–∞—Ç—É—Å=–û—Ç–∫—Ä—ã—Ç–∞. –î–ª—è unit_price —É–∫–∞–∂–∏—Ç–µ ¬´–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π x¬ª –∫–∞–∫ —Ü–µ–Ω—É –∑–∞ –µ–¥–∏–Ω–∏—Ü—É.
3) **–ü–ª–∞—Ç–µ–∂–∏** ‚Äî –≤–Ω–æ—Å–∏—Ç–µ –ø–ª–∞—Ç–µ–∂–∏: –≤—ã–±–µ—Ä–∏—Ç–µ —Å–µ–º—å—é –∏ —Ü–µ–ª—å –ø–æ –≤—ã–ø–∞–¥–∞—é—â–∏–º ¬´–ù–∞–∑–≤–∞–Ω–∏–µ (ID)¬ª, —É–∫–∞–∂–∏—Ç–µ —Å—É–º–º—É (>0) –∏ —Å–ø–æ—Å–æ–± (–°–ë–ü/–∫–∞—Ä—Ç–∞/–Ω–∞–ª–∏—á–Ω—ã–µ). –¶–µ–ª—å –º–æ–∂–Ω–æ –Ω–µ —É–∫–∞–∑—ã–≤–∞—Ç—å ‚Äî —ç—Ç–æ —Å–≤–æ–±–æ–¥–Ω—ã–π –ø–ª–∞—Ç—ë–∂.
4) **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ** ‚Äî –≤—ã–ø–æ–ª–Ω–∏—Ç–µ Funds ‚Üí Recalculate (Balance & Detail) –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ ¬´–ë–∞–ª–∞–Ω—Å¬ª, ¬´–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è¬ª, ¬´–°–≤–æ–¥–∫–∞¬ª.

### –ü–æ—à–∞–≥–æ–≤–æ —Å –∏–ª–ª—é—Å—Ç—Ä–∞—Ü–∏—è–º–∏

1. –û—Ç–∫—Ä—ã—Ç—å Apps Script –∏–∑ —Ç–∞–±–ª–∏—Ü—ã –∏ —Å–æ–∑–¥–∞—Ç—å —Å—Ü–µ–Ω–∞—Ä–∏–π:

  ![–û—Ç–∫—Ä—ã—Ç—å Apps Script](./screenshots/screen1.png)

2. –í—Å—Ç–∞–≤–∏—Ç—å –∫–æ–¥ –∏–∑ `Code.gs` –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä:

  ![–í—Å—Ç–∞–≤–∫–∞ –∫–æ–¥–∞](./screenshots/screen2.png)

3. –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å —Ñ–∞–π–ª –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ–µ–∫—Ç:

  ![–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞](./screenshots/screen3.png)

4. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –ø—Ä–æ–µ–∫—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω (–∑–Ω–∞—á–æ–∫ ¬´—Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ¬ª):

  ![–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞](./screenshots/screen5.png)

5. –í–µ—Ä–Ω—É—Ç—å—Å—è –≤ —Ç–∞–±–ª–∏—Ü—É. –ü–µ—Ä–µ–¥ –ø–µ—Ä–≤—ã–º –∑–∞–ø—É—Å–∫–æ–º –º–µ–Ω—é –º–æ–∂–µ—Ç –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –¥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:

  ![–î–æ –ø–æ—è–≤–ª–µ–Ω–∏—è –º–µ–Ω—é](./screenshots/screen6.png)

6. –û—Ç–∫—Ä—ã—Ç—å –º–µ–Ω—é Funds –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å Setup / Rebuild structure:

  ![–ú–µ–Ω—é Funds –ø–æ—è–≤–∏–ª–æ—Å—å](./screenshots/screen7.png)

7. –û–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –ø—É–Ω–∫—Ç–∞–º–∏ –º–µ–Ω—é:

  ![–ü—É–Ω–∫—Ç—ã –º–µ–Ω—é](./screenshots/screen8.png)

## –õ–∏—Å—Ç—ã –∏ –ø–æ–ª—è
- **–°–µ–º—å–∏**: –ò–º—è —Ä–µ–±—ë–Ω–∫–∞, –î–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è, –ú–∞–º–∞ —Ç–µ–ª–µ–≥—Ä–∞–º, –ü–∞–ø–∞ —Ç–µ–ª–µ–≥—Ä–∞–º, –∫–æ–Ω—Ç–∞–∫—Ç—ã —Ä–æ–¥–∏—Ç–µ–ª–µ–π, –ê–∫—Ç–∏–≤–µ–Ω, family_id (–∞–≤—Ç–æ)
- **–¶–µ–ª–∏ (v2.0)**: –ù–∞–∑–≤–∞–Ω–∏–µ —Ü–µ–ª–∏, –¢–∏–ø (—Ä–∞–∑–æ–≤–∞—è/—Ä–µ–≥—É–ª—è—Ä–Ω–∞—è), –°—Ç–∞—Ç—É—Å (–û—Ç–∫—Ä—ã—Ç–∞/–ó–∞–∫—Ä—ã—Ç–∞/–û—Ç–º–µ–Ω–µ–Ω–∞), –î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞, –î–µ–¥–ª–∞–π–Ω, –ù–∞—á–∏—Å–ª–µ–Ω–∏–µ, –ü–∞—Ä–∞–º–µ—Ç—Ä —Å—É–º–º—ã, –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π x, –ü–µ—Ä–∏–æ–¥–∏—á–Ω–æ—Å—Ç—å, –†–æ–¥–∏—Ç–µ–ª—å—Å–∫–∞—è —Ü–µ–ª—å, –ö –≤—ã–¥–∞—á–µ –¥–µ—Ç—è–º (–î–∞/–ù–µ—Ç), –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π, goal_id (–∞–≤—Ç–æ), –°—Å—ã–ª–∫–∞ –Ω–∞ –≥—É–≥–ª–¥–∏—Å–∫ (–æ–ø—Ü.)
- **–£—á–∞—Å—Ç–∏–µ**: goal_id (label), family_id (label), –°—Ç–∞—Ç—É—Å, –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
- **–ü–ª–∞—Ç–µ–∂–∏**: –î–∞—Ç–∞ (—Å–ø—Ä–∞–≤–æ—á–Ω–æ), family_id (label), goal_id (label) ‚Äî –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –°—É–º–º–∞ (>0), –°–ø–æ—Å–æ–±, –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π, payment_id (–∞–≤—Ç–æ)
- **–ë–∞–ª–∞–Ω—Å (v2.0)**: family_id, –ò–º—è —Ä–µ–±—ë–Ω–∫–∞, –í–Ω–µ—Å–µ–Ω–æ –≤—Å–µ–≥–æ, –°–ø–∏—Å–∞–Ω–æ –≤—Å–µ–≥–æ, –ó–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–æ, –°–≤–æ–±–æ–¥–Ω—ã–π –æ—Å—Ç–∞—Ç–æ–∫, –ó–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç—å
- **–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è**: family_id, –ò–º—è —Ä–µ–±—ë–Ω–∫–∞, goal_id, –ù–∞–∑–≤–∞–Ω–∏–µ —Ü–µ–ª–∏, –û–ø–ª–∞—á–µ–Ω–æ, –ù–∞—á–∏—Å–ª–µ–Ω–æ, –†–∞–∑–Ω–æ—Å—Ç—å (¬±), –†–µ–∂–∏–º; —Å–µ–ª–µ–∫—Ç–æ—Ä K1: OPEN/ALL
- **–°–≤–æ–¥–∫–∞**: goal_id, –ù–∞–∑–≤–∞–Ω–∏–µ, –†–µ–∂–∏–º, –°—É–º–º–∞ —Ü–µ–ª–∏, –°–æ–±—Ä–∞–Ω–æ, –£—á–∞—Å—Ç–Ω–∏–∫–æ–≤, –ü–ª–∞—Ç–µ–ª—å—â–∏–∫–æ–≤, –ï–¥–∏–Ω–∏—Ü –æ–ø–ª–∞—á–µ–Ω–æ, –ï—â—ë –ø–ª–∞—Ç–µ–ª—å—â–∏–∫–æ–≤ –¥–æ –∑–∞–∫—Ä—ã—Ç–∏—è, –û—Å—Ç–∞—Ç–æ–∫ –¥–æ —Ü–µ–ª–∏; —Å–µ–ª–µ–∫—Ç–æ—Ä K1: OPEN/ALL
- **–í—ã–¥–∞—á–∞** (–∂—É—Ä–Ω–∞–ª –≤—Ä—É—á–µ–Ω–∏–π): –î–∞—Ç–∞ –≤—ã–¥–∞—á–∏ (—Å–ø—Ä–∞–≤–æ—á–Ω–æ), goal_id (label), family_id (label), –ï–¥–∏–Ω–∏—Ü (>0), –ö—Ç–æ –≤—ã–¥–∞–ª, –í—ã–¥–∞–Ω–æ (–î–∞/–ù–µ—Ç), –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
- **–°—Ç–∞—Ç—É—Å –≤—ã–¥–∞—á–∏** (–¥–∞—à–±–æ—Ä–¥): goal_id, –ù–∞–∑–≤–∞–Ω–∏–µ, –°—Ç–∞—Ç—É—Å, x (—Ü–µ–Ω–∞), –ï–¥–∏–Ω–∏—Ü —Ç—Ä–µ–±—É–µ—Ç—Å—è, –ï–¥–∏–Ω–∏—Ü –æ–ø–ª–∞—á–µ–Ω–æ, –ï–¥–∏–Ω–∏—Ü –≤—ã–¥–∞–Ω–æ, –û—Å—Ç–∞—Ç–æ–∫ (—à—Ç)

–°–∫—Ä—ã—Ç—ã–π –ª–∏—Å—Ç Lists —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–π:
- `OPEN_GOALS_LABELS` ‚Äî –æ—Ç–∫—Ä—ã—Ç—ã–µ —Ü–µ–ª–∏ ¬´–ù–∞–∑–≤–∞–Ω–∏–µ (ID)¬ª
- `GOALS_LABELS` ‚Äî –≤—Å–µ —Ü–µ–ª–∏
- `ACTIVE_FAMILIES_LABELS` ‚Äî –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–µ–º—å–∏ ¬´–ò–º—è (ID)¬ª
- `FAMILIES_LABELS` ‚Äî –≤—Å–µ —Å–µ–º—å–∏

## –ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã ‚Äî –±—ã—Å—Ç—Ä–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
- –ß–∞—â–µ –≤—Å–µ–≥–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —É–¥–∞–ª–∏—Ç—å –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ –ª–∏—Å—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, ¬´–ë–∞–ª–∞–Ω—Å¬ª, ¬´–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è¬ª, ¬´–°–≤–æ–¥–∫–∞¬ª, ¬´Lists¬ª, ¬´–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è¬ª, ¬´–£—á–∞—Å—Ç–∏–µ¬ª) –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å Funds ‚Üí Setup / Rebuild structure ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–¥—É—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.
- –î–∞–Ω–Ω—ã–µ –Ω–∞ –±–∞–∑–æ–≤—ã—Ö –ª–∏—Å—Ç–∞—Ö ¬´–°–µ–º—å–∏¬ª, ¬´–°–±–æ—Ä—ã¬ª, ¬´–ü–ª–∞—Ç–µ–∂–∏¬ª —Å–æ—Ö—Ä–∞–Ω—è—Ç—Å—è; –æ–Ω–∏ —è–≤–ª—è—é—Ç—Å—è –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º –∏—Å—Ç–∏–Ω—ã –¥–ª—è –≤—Å–µ—Ö —Ä–∞—Å—á—ë—Ç–æ–≤.
- –õ–∏—Å—Ç ¬´–£—á–∞—Å—Ç–∏–µ¬ª –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–∏—Å—Ç–µ–º–æ–π –¥–ª—è —è–≤–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏, –Ω–æ –æ–Ω –æ–ø—Ü–∏–æ–Ω–∞–ª–µ–Ω –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è. –ï—Å–ª–∏ –µ–≥–æ –Ω–µ –∑–∞–ø–æ–ª–Ω—è—Ç—å ‚Äî —É—á–∞—Å—Ç–≤—É—é—Ç –≤—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–µ–º—å–∏. –£–¥–∞–ª—è—Ç—å –µ–≥–æ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ: Setup –≤—Å—ë —Ä–∞–≤–Ω–æ –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Å—Ç –ª–∏—Å—Ç –ø—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã.

## –†–µ–∂–∏–º—ã –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –∏ –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã
- static_per_child (—Ñ–∏–∫—Å –Ω–∞ —Å–µ–º—å—é):
  - –û–¥–∏–Ω –ø–ª–∞—Ç–∏—Ç: –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ = —Å—Ç–∞–≤–∫–∞ –≤—Å–µ–º —É—á–∞—Å—Ç–Ω–∏–∫–∞–º, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ç–æ–≥–æ, –∫—Ç–æ –ø–ª–∞—Ç–∏–ª; –ø–ª–∞—Ç–∏–≤—à–∏–π –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –ø–µ—Ä–µ–ø–ª–∞—Ç—É.
  - –ù–µ—Å–∫–æ–ª—å–∫–æ –ø–ª–∞—Ç—è—Ç: —É –≤—Å–µ—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ = —Å—Ç–∞–≤–∫–∞; –ø–µ—Ä–µ–ø–ª–∞—Ç–∞/–Ω–µ–¥–æ–ø–ª–∞—Ç–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∏—Ö –ø–ª–∞—Ç–µ–∂–µ–π.
- shared_total_all (T/N –Ω–∞ –≤—Å–µ—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤):
  - –û–¥–∏–Ω –ø–ª–∞—Ç–∏—Ç: –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ = T/N –≤—Å–µ–º —É—á–∞—Å—Ç–Ω–∏–∫–∞–º; –ø–ª–∞—Ç–∏–≤—à–∏–π –º–æ–∂–µ—Ç –ø–æ–∫—Ä—ã—Ç—å –±–æ–ª—å—à–µ —Å–≤–æ–µ–π –¥–æ–ª–∏ (–ø–µ—Ä–µ–ø–ª–∞—Ç–∞) –¥–æ –æ–ø–ª–∞—Ç—ã –¥—Ä—É–≥–∏–º–∏.
  - –ù–µ—Å–∫–æ–ª—å–∫–æ –ø–ª–∞—Ç—è—Ç: –∫–∞–∂–¥–æ–º—É –Ω–∞—á–∏—Å–ª–µ–Ω–æ –æ–¥–∏–Ω–∞–∫–æ–≤–æ = T/N; –ø–µ—Ä–µ–ø–ª–∞—Ç—ã —É —Ä–∞–Ω–Ω–∏—Ö –ø–ª–∞—Ç–µ–ª—å—â–∏–∫–æ–≤ –¥–æ –¥–æ–±–æ—Ä–∞ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö.
- shared_total_by_payers (T/K —Ç–æ–ª—å–∫–æ –¥–ª—è –æ–ø–ª–∞—Ç–∏–≤—à–∏—Ö):
  - –û–¥–∏–Ω –ø–ª–∞—Ç–∏—Ç: K=1 ‚Üí –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ —ç—Ç–æ–º—É –ø–ª–∞—Ç–µ–ª—å—â–∏–∫—É = T/1 = T; —É –Ω–µ–≥–æ –±—É–¥–µ—Ç –Ω–µ–¥–æ–ø–ª–∞—Ç–∞, –µ—Å–ª–∏ –≤–Ω—ë—Å < T.
  - –ù–µ—Å–∫–æ–ª—å–∫–æ –ø–ª–∞—Ç—è—Ç: –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ –∫–∞–∂–¥–æ–π –ø–ª–∞—Ç–∏–≤—à–µ–π —Å–µ–º—å–µ = T/K; –Ω–µ –ø–ª–∞—Ç–∏–≤—à–∏–µ –ø–æ–ª—É—á–∞—é—Ç 0.
- dynamic_by_payers (water‚Äëfilling):
  - –û–¥–∏–Ω –ø–ª–∞—Ç–∏—Ç: x = min(T, P1) ‚Üí –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ = min(P1, x) = P1, –Ω–µ–¥–æ–ø–ª–∞—Ç—ã –Ω–µ—Ç (–ø–æ–∫–∞ –æ–¥–∏–Ω –ø–ª–∞—Ç—è—â–∏–π).
  - –ù–µ—Å–∫–æ–ª—å–∫–æ –ø–ª–∞—Ç—è—Ç: –Ω–∞—Ö–æ–¥–∏—Ç—Å—è x —Ç–∞–∫–æ–µ, —á—Ç–æ Œ£ min(P_i, x) = min(T, Œ£P_i); –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ —Å–µ–º—å–µ i = min(P_i, x). –ü–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ¬´–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π x¬ª.

- proportional_by_payers (–ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –ø–ª–∞—Ç–∏–≤—à–∏–º):
  - –û–¥–∏–Ω –ø–ª–∞—Ç–∏—Ç: –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ = T (—Ü–µ–ª–∏–∫–æ–º —ç—Ç–æ–º—É –ø–ª–∞—Ç–µ–ª—å—â–∏–∫—É), –µ—Å–ª–∏ –æ–Ω –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –ø–ª–∞—Ç–∏–≤—à–∏–π; —É –Ω–µ–≥–æ –±—É–¥–µ—Ç –Ω–µ–¥–æ–ø–ª–∞—Ç–∞, –µ—Å–ª–∏ –≤–Ω—ë—Å < T.
  - –ù–µ—Å–∫–æ–ª—å–∫–æ –ø–ª–∞—Ç—è—Ç: –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ —Å–µ–º—å–µ i = T ¬∑ P_i / Œ£P —Ç–æ–ª—å–∫–æ —Å—Ä–µ–¥–∏ –ø–ª–∞—Ç–∏–≤—à–∏—Ö; –Ω–µ –ø–ª–∞—Ç–∏–≤—à–∏–µ –ø–æ–ª—É—á–∞—é—Ç 0.

- unit_price_by_payers (—Ü–µ–Ω–∞ –µ–¥–∏–Ω–∏—Ü—ã ‚Äî –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π x):
  - –û–¥–∏–Ω –ø–ª–∞—Ç–∏—Ç: –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ = min(P1, x). –ï—Å–ª–∏ P1 ‚â• x, –¥–æ–ª–≥ –Ω–µ –æ–±—Ä–∞–∑—É–µ—Ç—Å—è –≤ —Ä–∞–º–∫–∞—Ö —ç—Ç–æ–≥–æ —Å–±–æ—Ä–∞ –¥–ª—è –Ω–µ–≥–æ; –∑–∞–∫—É–ø–∫–∞ —Å—á–∏—Ç–∞–µ—Ç—Å—è –∑–∞ –µ–¥–∏–Ω–∏—Ü–∞–º–∏ –ø–æ x.
  - –ù–µ—Å–∫–æ–ª—å–∫–æ –ø–ª–∞—Ç—è—Ç: –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ —Å–µ–º—å–µ i = floor(P_i/x)¬∑x (—Ç–æ–ª—å–∫–æ –ø–æ–ª–Ω—ã–µ –µ–¥–∏–Ω–∏—Ü—ã). –í ¬´–°–≤–æ–¥–∫–µ¬ª: ¬´–£—á–∞—Å—Ç–Ω–∏–∫–æ–≤¬ª = ceil(T/x), ¬´–ü–ª–∞—Ç–µ–ª—å—â–∏–∫–æ–≤¬ª = ‚åä–°–æ–±—Ä–∞–Ω–æ/x‚åã (–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ –µ–¥–∏–Ω–∏—Ü—ã), ¬´–ï—â—ë –ø–ª–∞—Ç–µ–ª—å—â–∏–∫–æ–≤¬ª ‚âà ceil(–æ—Å—Ç–∞—Ç–æ–∫/x).

### –í—ã–¥–∞—á–∞ –µ–¥–∏–Ω–∏—Ü: –∫–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
- –í–∫–ª—é—á–µ–Ω–∏–µ: —Ç–æ–ª—å–∫–æ –¥–ª—è unit_price_by_payers. –í ¬´–°–±–æ—Ä—ã¬ª –ø–æ—Å—Ç–∞–≤—å—Ç–µ ¬´–ö –≤—ã–¥–∞—á–µ –¥–µ—Ç—è–º¬ª = –î–∞ –∏ –∑–∞–¥–∞–π—Ç–µ ¬´–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π x¬ª –∫–∞–∫ —Ü–µ–Ω—É –∑–∞ –µ–¥–∏–Ω–∏—Ü—É (> 0).
- –ñ—É—Ä–Ω–∞–ª ¬´–í—ã–¥–∞—á–∞¬ª: –∑–∞–Ω–æ—Å–∏—Ç–µ –≤—Ä—É—á–µ–Ω–∏—è –≤—Ä—É—á–Ω—É—é. –í–∞–ª–∏–¥–∞—Ü–∏–∏: collection_id ‚Äî –∏–∑ –≤—Å–µ—Ö —Å–±–æ—Ä–æ–≤ (COLLECTIONS_LABELS), family_id ‚Äî –∏–∑ –≤—Å–µ—Ö —Å–µ–º–µ–π (FAMILIES_LABELS), ¬´–ï–¥–∏–Ω–∏—Ü¬ª > 0, ¬´–í—ã–¥–∞–Ω–æ¬ª = –î–∞/–ù–µ—Ç.
- –î–∞—à–±–æ—Ä–¥ ¬´–°—Ç–∞—Ç—É—Å –≤—ã–¥–∞—á–∏¬ª —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
  - –ï–¥–∏–Ω–∏—Ü —Ç—Ä–µ–±—É–µ—Ç—Å—è = ceil(T/x)
  - –ï–¥–∏–Ω–∏—Ü –æ–ø–ª–∞—á–µ–Ω–æ = ‚åä—Å–æ–±—Ä–∞–Ω–æ/x‚åã (–ø–æ –ø–ª–∞—Ç–µ–∂–∞–º)
  - –ï–¥–∏–Ω–∏—Ü –≤—ã–¥–∞–Ω–æ = —Å—É–º–º–∞ ¬´–ï–¥–∏–Ω–∏—Ü¬ª —Å –í—ã–¥–∞–Ω–æ=–î–∞
  - –û—Å—Ç–∞—Ç–æ–∫ (—à—Ç) = max(0, –¢—Ä–µ–±—É–µ—Ç—Å—è ‚àí –í—ã–¥–∞–Ω–æ)
–ü—Ä–∏–º–µ—á–∞–Ω–∏—è: –¥–∞—à–±–æ—Ä–¥ —É—á–∏—Ç—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø–æ—à—Ç—É—á–Ω—ã–µ —Å–±–æ—Ä—ã —Å –≤–∞–ª–∏–¥–Ω–æ–π —Ü–µ–Ω–æ–π x –∏ –≤–∫–ª—é—á—ë–Ω–Ω—ã–º —Ñ–ª–∞–≥–æ–º. –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö –Ω–∞ ¬´–°–±–æ—Ä—ã¬ª, ¬´–ü–ª–∞—Ç–µ–∂–∏¬ª –∏ ¬´–í—ã–¥–∞—á–∞¬ª, –∞ —Ç–∞–∫–∂–µ —á–µ—Ä–µ–∑ Recalculate.

## –°—Ü–µ–Ω–∞—Ä–∏–∏ –∏–∑ –∂–∏–∑–Ω–∏: —á—Ç–æ –≤—ã–±—Ä–∞—Ç—å –∏ –ø–æ—á–µ–º—É —É—á—ë—Ç —Ä–∞–∑–Ω—ã–π

–ù–∏–∂–µ ‚Äî —Ç–∏–ø–æ–≤—ã–µ —Å—é–∂–µ—Ç—ã –∏–∑ –ø—Ä–∞–∫—Ç–∏–∫–∏ —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–µ–π —Ä–µ–∂–∏–º–∞, –ø—Ä–∏–Ω—Ü–∏–ø–æ–º —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç–∏ –∏ –∫–æ—Ä–æ—Ç–∫–∏–º —á–∏—Å–ª–æ–≤—ã–º –ø—Ä–∏–º–µ—Ä–æ–º.

1) static_per_child ‚Äî ¬´—Ñ–∏–∫—Å —Å —Å–µ–º—å–∏¬ª
- –ö–æ–≥–¥–∞: –æ–¥–∏–Ω–∞–∫–æ–≤–∞—è —Å—É–º–º–∞ –¥–ª—è –∫–∞–∂–¥–æ–π —Å–µ–º—å–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ç–æ–≥–æ, –ø–ª–∞—Ç–∏–ª–∏ –æ–Ω–∏ –∏–ª–∏ –Ω–µ—Ç. –ü—Ä–∏–º–µ—Ä—ã: ¬´–ï–∂–µ–º–µ—Å—è—á–Ω—ã–π –∫–ª–∞—Å—Å–Ω—ã–π —Ñ–æ–Ω–¥ –ø–æ 500 ‚ÇΩ¬ª, ¬´–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã–π –≤–∑–Ω–æ—Å 300 ‚ÇΩ¬ª.
- –ü–æ—á–µ–º—É —Ç–∞–∫–æ–π —É—á—ë—Ç: —É—Å–ª—É–≥–∞/–ø–æ–ª—å–∑–∞ –æ–¥–∏–Ω–∞–∫–æ–≤–∞ –¥–ª—è –≤—Å–µ—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ (–∫–∞–∂–¥–∞—è —Å–µ–º—å—è –Ω–µ—Å—ë—Ç —Ä–∞–≤–Ω—É—é –¥–æ–ª—é), –ø–æ—ç—Ç–æ–º—É –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ –∏–¥—ë—Ç –≤—Å–µ–º —É—á–∞—Å—Ç–≤—É—é—â–∏–º.
- –ö–∞–∫ —Å—á–∏—Ç–∞–µ—Ç—Å—è: –∫–∞–∂–¥–æ–º—É —É—á–∞—Å—Ç–Ω–∏–∫—É —Å–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è —Å—Ç–∞–≤–∫–∞ S.
- –ü—Ä–∏–º–µ—Ä: 10 —Å–µ–º–µ–π, S=500 ‚Üí —Ü–µ–ª—å = 10√ó500=5000. –¢—Ä–æ–µ –∑–∞–ø–ª–∞—Ç–∏–ª–∏ –ø–æ 500, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–∑–∂–µ. –£ —Ä–∞–Ω–Ω–∏—Ö –≤—Ä–µ–º–µ–Ω–Ω–æ –ø–µ—Ä–µ–ø–ª–∞—Ç–∞, –Ω–æ –¥–æ–ª–≥–æ–≤ –Ω–µ—Ç —É —Ç–µ—Ö, –∫—Ç–æ –≤–Ω—ë—Å S.

2) shared_total_all ‚Äî ¬´–¥–µ–ª–∏–º –æ–±—â—É—é —Å—É–º–º—É –Ω–∞ –≤—Å–µ—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤¬ª
- –ö–æ–≥–¥–∞: –∏–∑–≤–µ—Å—Ç–Ω–∞ –æ–±—â–∞—è —Ü–µ–ª—å T (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∞—Ä–µ–Ω–¥–∞ –∞–≤—Ç–æ–±—É—Å–∞), –∏ —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ —Ä–∞–∑–¥–µ–ª–∏—Ç—å –µ—ë –º–µ–∂–¥—É –≤—Å–µ–º–∏, –∫—Ç–æ —É—á–∞—Å—Ç–≤—É–µ—Ç. –ü—Ä–∏–º–µ—Ä—ã: ¬´–ü–æ–µ–∑–¥–∫–∞ T=12‚ÄØ000 ‚ÇΩ –Ω–∞ 8 –¥–µ—Ç–µ–π¬ª, ¬´–ü–µ—á–∞—Ç—å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π T=6‚ÄØ000 ‚ÇΩ –Ω–∞ –∫–ª–∞—Å—Å¬ª.
- –ü–æ—á–µ–º—É —Ç–∞–∫–æ–π —É—á—ë—Ç: –ø–æ–ª—å–∑–∞/–∑–∞—Ç—Ä–∞—Ç—ã —Ä–∞–∑–¥–µ–ª—è—é—Ç—Å—è —Ä–∞–≤–Ω—ã–º–∏ –¥–æ–ª—è–º–∏ –º–µ–∂–¥—É –≤—Å–µ–º–∏ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ç–æ–≥–æ, –∫—Ç–æ –ø–ª–∞—Ç–∏–ª —Ä–∞–Ω—å—à–µ.
- –ö–∞–∫ —Å—á–∏—Ç–∞–µ—Ç—Å—è: –¥–æ–ª—è = T/N, –Ω–∞—á–∏—Å–ª—è–µ—Ç—Å—è –≤—Å–µ–º —É—á–∞—Å—Ç–Ω–∏–∫–∞–º; —Ä–∞–Ω–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∏ –º–æ–≥—É—Ç –∫–∞–∑–∞—Ç—å—Å—è ¬´–ø–µ—Ä–µ–ø–ª–∞—Ç–æ–π¬ª, –ø–æ–∫–∞ –Ω–µ –¥–æ–±–µ—Ä—É—Ç –æ—Å—Ç–∞–ª—å–Ω—ã–µ.
- –ü—Ä–∏–º–µ—Ä: T=12‚ÄØ000, N=8 ‚Üí 1500 ‚ÇΩ –∫–∞–∂–¥–æ–º—É. –ï—Å–ª–∏ —Å–µ–º—å—è –∑–∞–ø–ª–∞—Ç–∏–ª–∞ 3000, —É –Ω–µ—ë –≤—Ä–µ–º–µ–Ω–Ω–∞—è –ø–µ—Ä–µ–ø–ª–∞—Ç–∞ 1500.

3) shared_total_by_payers ‚Äî ¬´–¥–µ–ª–∏–º –æ–±—â—É—é —Å—É–º–º—É —Ç–æ–ª—å–∫–æ –º–µ–∂–¥—É –ø–ª–∞—Ç–∏–≤—à–∏–º–∏¬ª
- –ö–æ–≥–¥–∞: —Ä–∞—Å—Ö–æ–¥—ã –¥–æ–ª–∂–Ω—ã –Ω–µ—Å—Ç–∏ —Ç–æ–ª—å–∫–æ —Ç–µ, –∫—Ç–æ —Ä–µ–∞–ª—å–Ω–æ –≤–Ω–µ—Å –¥–µ–Ω—å–≥–∏. –ü—Ä–∏–º–µ—Ä—ã: ¬´–°–ø–æ–Ω—Ç–∞–Ω–Ω—ã–π –ø–æ–¥–∞—Ä–æ–∫ –æ—Ç —Ç–µ—Ö, –∫—Ç–æ —Å–∫–∏–Ω—É–ª—Å—è¬ª, ¬´–î–æ–±—Ä–æ–≤–æ–ª—å–Ω—ã–π —Å–±–æ—Ä T=10‚ÄØ000 ‚ÇΩ –Ω–∞ —Ä–µ–º–æ–Ω—Ç –∫–∞–±–∏–Ω–µ—Ç–∞ –±–µ–∑ –æ–±—è–∑–∞–ª–æ–≤–∫–∏¬ª.
- –ü–æ—á–µ–º—É —Ç–∞–∫–æ–π —É—á—ë—Ç: –ø—Ä–∏–Ω—Ü–∏–ø –¥–æ–±—Ä–æ–≤–æ–ª—å–Ω–æ—Å—Ç–∏ ‚Äî –¥–æ–ª—è —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å—Ä–µ–¥–∏ —Ç–µ—Ö, –∫—Ç–æ —É—á–∞—Å—Ç–≤–æ–≤–∞–ª –ø–ª–∞—Ç–µ–∂–æ–º; –Ω–µ –ø–ª–∞—Ç–∏–≤—à–∏–µ –Ω–µ –ø–æ–ª—É—á–∞—é—Ç –Ω–∞—á–∏—Å–ª–µ–Ω–∏–π/–¥–æ–ª–≥–æ–≤.
- –ö–∞–∫ —Å—á–∏—Ç–∞–µ—Ç—Å—è: –¥–æ–ª—è = T/K, –≥–¥–µ K ‚Äî —á–∏—Å–ª–æ –ø–ª–∞—Ç–µ–ª—å—â–∏–∫–æ–≤; –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –ø–ª–∞—Ç–µ–ª—å—â–∏–∫–∞–º.
- –ü—Ä–∏–º–µ—Ä: T=10‚ÄØ000, –ø–ª–∞—Ç–∏–ª–æ 4 —Å–µ–º—å–∏ ‚Üí –ø–æ 2500 –Ω–∞—á–∏—Å–ª–µ–Ω–æ –∫–∞–∂–¥–æ–º—É –∏–∑ —ç—Ç–∏—Ö 4; –æ—Å—Ç–∞–ª—å–Ω—ã–µ ‚Äî 0.

4) dynamic_by_payers ‚Äî ¬´–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ (cap x, water‚Äëfilling)¬ª
- –ö–æ–≥–¥–∞: –æ–±—â–∞—è —Ü–µ–ª—å T –∏–∑–≤–µ—Å—Ç–Ω–∞, –Ω–æ –≤–Ω–æ—Å—è—Ç –Ω–µ—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ/–≤ —Ä–∞–∑–Ω–æ–µ –≤—Ä–µ–º—è, –∏ –Ω—É–∂–Ω–æ ¬´–≤—ã—Ä–∞–≤–Ω–∏–≤–∞—Ç—å¬ª —Ä–∞–Ω–Ω–∏–µ –ø–µ—Ä–µ–ø–ª–∞—Ç—ã –ø–æ –º–µ—Ä–µ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏–π. –ü—Ä–∏–º–µ—Ä—ã: ¬´–°–±–æ—Ä –Ω–∞ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ T=9000¬ª, ¬´–î–ª–∏–Ω–Ω—ã–π —Å–±–æ—Ä, –≥–¥–µ –∏–¥—É—Ç —á–∞—Å—Ç–∏—á–Ω—ã–µ –≤–∑–Ω–æ—Å—ã¬ª.
- –ü–æ—á–µ–º—É —Ç–∞–∫–æ–π —É—á—ë—Ç: —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç—å —á–µ—Ä–µ–∑ –≤–µ—Ä—Ö–Ω—é—é –≥—Ä–∞–Ω–∏—Ü—É x –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–ª–∞—Ç–µ–ª—å—â–∏–∫–∞: –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ i = min(P_i, x). x –ø–æ–¥–±–∏—Ä–∞–µ—Ç—Å—è —Ç–∞–∫, —á—Ç–æ–±—ã Œ£ min(P_i, x) = min(T, Œ£P_i). –ü–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è x —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è ‚Äî –≤—Å–µ –≤–∏–¥—è—Ç –∏—Ç–æ–≥–æ–≤—É—é —Ä–∞–≤–Ω—É—é ¬´–ø–ª–∞–Ω–∫—É¬ª.
- –ö–∞–∫ —Å—á–∏—Ç–∞–µ—Ç—Å—è: –ø–æ–∫–∞ —Å–±–æ—Ä –æ—Ç–∫—Ä—ã—Ç ‚Äî x –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø–æ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–º –ø–ª–∞—Ç–µ–∂–∞–º; –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ ¬´–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π x¬ª, –¥–∞–ª—å—à–µ –±–µ—Ä—ë—Ç—Å—è –∏–∑ –Ω–µ–≥–æ.
- –ü—Ä–∏–º–µ—Ä: T=9000, –ø–ª–∞—Ç–µ–∂–∏ [2000,2000,700,700,700,700,700] ‚Üí x‚âà1250; –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è: [1250,1250,700,700,700,700,700].

5) proportional_by_payers ‚Äî ¬´–ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –≤–Ω–µ—Å—ë–Ω–Ω—ã–º —Å—É–º–º–∞–º (–±–µ–∑ –¥–æ–ª–≥–æ–≤)¬ª
- –ö–æ–≥–¥–∞: —ç—Ç–æ —Å–∫–æ—Ä–µ–µ ¬´–ø–æ–∂–µ—Ä—Ç–≤–æ–≤–∞–Ω–∏—è –¥–æ —Ü–µ–ª–∏¬ª, –≥–¥–µ –Ω–∏–∫—Ç–æ –Ω–µ –¥–æ–ª–∂–µ–Ω, –Ω–æ —Ö–æ—á–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç—å ¬´—Å–ø–∏—Å–∞–Ω–∏–µ¬ª –ø–æ –≤–∑–Ω–æ—Å–∞–º. –ü—Ä–∏–º–µ—Ä—ã: ¬´–ü–æ–º–æ—â—å –∫–ª–∞—Å—Å—É T=8000¬ª, ¬´–°–±–æ—Ä –Ω–∞ –ø–æ–¥–∞—Ä–∫–∏ –∫–æ–º—É —É–¥–æ–±–Ω–æ, –±–µ–∑ –æ–±—è–∑–∞–ª–æ–≤–∫–∏¬ª.
- –ü–æ—á–µ–º—É —Ç–∞–∫–æ–π —É—á—ë—Ç: –∫—Ç–æ –≤–Ω—ë—Å –±–æ–ª—å—à–µ ‚Äî —É —Ç–æ–≥–æ –±–æ–ª—å—à–µ ¬´—Å–ø–∏—Å–∞–Ω–æ¬ª, –Ω–æ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –±–æ–ª—å—à–µ –ø–ª–∞—Ç–µ–∂–∞; –Ω–µ –ø–ª–∞—Ç–∏–≤—à–∏–µ –Ω–∏—á–µ–≥–æ –Ω–µ –¥–æ–ª–∂–Ω—ã.
- –ö–∞–∫ —Å—á–∏—Ç–∞–µ—Ç—Å—è: –±–µ—Ä—ë–º target = min(T, Œ£P); –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ i = P_i √ó (target/Œ£P). –ü—Ä–∏ –Ω–µ–¥–æ–±–æ—Ä–µ —Å–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤–µ—Å—å –ø–ª–∞—Ç—ë–∂, –ø—Ä–∏ –ø–µ—Ä–µ–±–æ—Ä–µ ‚Äî –≤—Å–µ —É–º–µ–Ω—å—à–∞—é—Ç—Å—è –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ.
- –ü—Ä–∏–º–µ—Ä: T=8000, –ø–ª–∞—Ç–µ–∂–∏ [3000,2000,1500,800,500] (Œ£=7800) ‚Üí —Å–ø–∏—Å—ã–≤–∞–µ–º 7800 –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –¥–æ–ª—è–º, –¥–æ–ª–≥–æ–≤ –Ω–µ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç.

6) unit_price_by_payers ‚Äî ¬´–ø–æ—à—Ç—É—á–Ω–∞—è –∑–∞–∫—É–ø–∫–∞ –ø–æ —Ü–µ–Ω–µ x¬ª
- –ö–æ–≥–¥–∞: –ø–æ–∫—É–ø–∞—é—Ç—Å—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ ¬´–µ–¥–∏–Ω–∏—Ü—ã¬ª —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ü–µ–Ω–æ–π (—Ñ–æ—Ä–º–∞, —Ç–µ—Ç—Ä–∞–¥–∏, –±–∏–ª–µ—Ç—ã), –∏ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ –∏–¥—ë—Ç —Ç–æ–ª—å–∫–æ –ø–ª–∞—Ç–µ–ª—å—â–∏–∫—É, –º–∞–∫—Å–∏–º—É–º –¥–æ x. –ü—Ä–∏–º–µ—Ä—ã: ¬´–£—á–µ–Ω–∏—á–µ—Å–∫–∏–π –∫–æ–º–ø–ª–µ–∫—Ç x=78 ‚ÇΩ –∑–∞ —à—Ç—É–∫—É¬ª, ¬´–°–ø–æ—Ä—Ç–∏–≤–Ω–∞—è —Ñ–æ—Ä–º–∞ x=1500 ‚ÇΩ¬ª.
- –ü–æ—á–µ–º—É —Ç–∞–∫–æ–π —É—á—ë—Ç: –∫–∞–∂–¥–∞—è –æ–ø–ª–∞—á–µ–Ω–Ω–∞—è –µ–¥–∏–Ω–∏—Ü–∞ ¬´–∑–∞–∫—Ä—ã–≤–∞–µ—Ç¬ª –æ–¥–Ω—É —à—Ç—É–∫—É, –¥–æ–ª–≥ –ø–æ —Å–∞–º–æ–º—É —ç—Ç–æ–º—É —Å–±–æ—Ä—É –Ω–µ –æ–±—Ä–∞–∑—É–µ—Ç—Å—è, –µ—Å–ª–∏ –≤–Ω–µ—Å–µ–Ω–æ ‚â• x; –Ω–µ –ø–ª–∞—Ç–∏–ª ‚Äî –Ω–µ—Ç —Å–ø–∏—Å–∞–Ω–∏—è.
- –ö–∞–∫ —Å—á–∏—Ç–∞–µ—Ç—Å—è: –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ i = floor(P_i/x)¬∑x (—Ç–æ–ª—å–∫–æ –ø–æ–ª–Ω—ã–µ –µ–¥–∏–Ω–∏—Ü—ã), —Ç–æ–ª—å–∫–æ –ø–ª–∞—Ç–∏–≤—à–∏–º. –í ¬´–°–≤–æ–¥–∫–µ¬ª: –£—á–∞—Å—Ç–Ω–∏–∫–æ–≤ ‚âà ceil(T/x) ‚Äî —Å–∫–æ–ª—å–∫–æ —à—Ç—É–∫ –Ω—É–∂–Ω–æ; –ï–¥–∏–Ω–∏—Ü –æ–ø–ª–∞—á–µ–Ω–æ = ‚åä–°–æ–±—Ä–∞–Ω–æ/x‚åã ‚Äî —Å–∫–æ–ª—å–∫–æ —à—Ç—É–∫ —É–∂–µ –ø—Ä–æ—Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–æ; –ü–ª–∞—Ç–µ–ª—å—â–∏–∫–æ–≤ ‚Äî —á–∏—Å–ª–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–ª–∞—Ç–∏–≤—à–∏—Ö —Å–µ–º–µ–π.
- –ü—Ä–∏–º–µ—Ä: T=780, x=78; –ø–ª–∞—Ç–µ–∂–∏ 8√ó78 –∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —á–∞—Å—Ç–∏—á–Ω—ã—Ö ‚Üí –£—á–∞—Å—Ç–Ω–∏–∫–æ–≤=10, –ü–ª–∞—Ç–µ–ª—å—â–∏–∫–æ–≤=8, –û—Å—Ç–∞—Ç–æ–∫=156 (2 —à—Ç—É–∫–∏).

–ö—Ä–∞—Ç–∫–∏–π –Ω–∞–≤–∏–≥–∞—Ç–æ—Ä –≤—ã–±–æ—Ä–∞ —Ä–µ–∂–∏–º–∞
- –§–∏–∫—Å –Ω–∞ –≤—Å–µ—Ö –æ–¥–∏–Ω–∞–∫–æ–≤–æ? ‚Üí static_per_child.
- –ï—Å—Ç—å –æ–±—â–∞—è —Ü–µ–ª—å –∏ —É—á–∞—Å—Ç–≤—É—é—Ç –≤—Å–µ? ‚Üí shared_total_all.
- –î–æ–±—Ä–æ–≤–æ–ª—å–Ω–æ: –ø–ª–∞—Ç–∏—Ç –∫—Ç–æ —Ö–æ—á–µ—Ç ‚Äî –¥–µ–ª–∏–º —Ç–æ–ª—å–∫–æ —Å—Ä–µ–¥–∏ –ø–ª–∞—Ç–∏–≤—à–∏—Ö? ‚Üí shared_total_by_payers.
- –ù—É–∂–Ω–∞ ¬´—á–µ—Å—Ç–Ω–∞—è –ø–ª–∞–Ω–∫–∞¬ª –ø—Ä–∏ –Ω–µ—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–∞—Ö –∏ –ø–æ—Ç–æ–º –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –∏—Ç–æ–≥? ‚Üí dynamic_by_payers.
- –ü–æ–∂–µ—Ä—Ç–≤–æ–≤–∞–Ω–∏—è –±–µ–∑ –¥–æ–ª–≥–æ–≤ (—Å–ø–∏—Å—ã–≤–∞—Ç—å –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ —Ñ–∞–∫—Ç—É) ‚Üí proportional_by_payers.
- –ü–æ—à—Ç—É—á–Ω—ã–µ –ø–æ–∫—É–ø–∫–∏ —Å —Ü–µ–Ω–æ–π –∑–∞ —à—Ç—É–∫—É ‚Üí unit_price_by_payers.

## –ü–µ—Ä–µ—Å—á—ë—Ç –ë–∞–ª–∞–Ω—Å–∞, –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –°–≤–æ–¥–∫–∏
- –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–µ–∂–∏–º–∞/–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –∏–ª–∏ –º–∞—Å—Å–æ–≤—ã—Ö –ø—Ä–∞–≤–æ–∫ ¬´–£—á–∞—Å—Ç–∏–µ¬ª/¬´–ü–ª–∞—Ç–µ–∂–∏¬ª –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Funds ‚Üí Recalculate (Balance & Detail) ‚Äî –æ–Ω –æ–±–Ω–æ–≤–ª—è–µ—Ç —Ç–∞–∫–∂–µ ¬´–°–≤–æ–¥–∫–∞¬ª.
- –ë–∞–ª–∞–Ω—Å –∞–≤—Ç–æ‚Äë–æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –ø—Ä–∞–≤–∫–∞—Ö –Ω–∞ ¬´–ü–ª–∞—Ç–µ–∂–∏¬ª, ¬´–°–µ–º—å–∏¬ª, ¬´–°–±–æ—Ä—ã¬ª. ¬´–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è¬ª –∏ ¬´–°–≤–æ–¥–∫–∞¬ª –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (—á–µ—Ä–µ–∑ —Ç–∏–∫) –∏–ª–∏ —á–µ—Ä–µ–∑ Recalculate.

## –§–æ—Ä–º—É–ª—ã –∏ —Ñ—É–Ω–∫—Ü–∏–∏
- LABEL_TO_ID(value) ‚Äî –∏–∑–≤–ª–µ–∫–∞–µ—Ç ID –∏–∑ ¬´–ù–∞–∑–≤–∞–Ω–∏–µ (ID)¬ª –∏–ª–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏—Å—Ö–æ–¥–Ω–æ–µ, –µ—Å–ª–∏ —ç—Ç–æ —É–∂–µ ID
- PAYED_TOTAL_FAMILY(family) ‚Äî —Å—É–º–º–∞ –≤—Å–µ—Ö –ø–ª–∞—Ç–µ–∂–µ–π —Å–µ–º—å–∏
- ACCRUED_FAMILY(family, statusFilter) ‚Äî –Ω–∞—á–∏—Å–ª–µ–Ω–æ —Å–µ–º—å–µ –ø–æ —Ä–µ–∂–∏–º–∞–º –∏ —É—á–∞—Å—Ç–∏—é; statusFilter: OPEN –∏–ª–∏ ALL
- DYN_CAP(T, payments_range) ‚Äî cap x –ø–æ water-filling
 

## –ó–∞–∫—Ä—ã—Ç–∏–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π —Ü–µ–ª–∏
Funds ‚Üí Close Goal ‚Üí –≤–≤–µ–¥–∏—Ç–µ goal_id (–Ω–∞–ø—Ä–∏–º–µ—Ä, G003). –°–∫—Ä–∏–ø—Ç –ø–æ—Å—á–∏—Ç–∞–µ—Ç x –ø–æ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–º –ø–ª–∞—Ç–µ–∂–∞–º —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤, –∑–∞–ø–∏—à–µ—Ç ¬´–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π x¬ª –∏ –ø–æ—Å—Ç–∞–≤–∏—Ç –°—Ç–∞—Ç—É—Å=–ó–∞–∫—Ä—ã—Ç–∞. –î–ª—è –¥—Ä—É–≥–∏—Ö —Ä–µ–∂–∏–º–æ–≤ ¬´–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π x¬ª –Ω–µ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏.

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –í—Å—ë —á—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å –ø–∞–∫–µ—Ç–Ω–æ; —Ñ–æ—Ä–º—É–ª—ã ¬´–ë–∞–ª–∞–Ω—Å¬ª –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–º —á–∏—Å–ª–æ–º —Å–µ–º–µ–π
- ¬´–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è¬ª –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –æ–¥–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π –∏–∑ –±–∞—Ç—á‚Äë–¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å —Ç–∞–π–º–∞—É—Ç–æ–≤
- –ê–≤—Ç–æ‚Äë—Ä–µ—Ñ—Ä–µ—à ¬´–ë–∞–ª–∞–Ω—Å¬ª –∏ ¬´–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è¬ª —Ç–æ–ª—å–∫–æ –Ω–∞ –∑–Ω–∞—á–∏–º—ã–µ –ø—Ä–∞–≤–∫–∏

## –ü–æ–¥—Å–∫–∞–∑–∫–∏
- –ï—Å–ª–∏ –≤—ã–ø–∞–¥–∞—é—â–∏–µ –ø—É—Å—Ç—ã–µ ‚Äî Funds ‚Üí Rebuild data validations
- –ï—Å–ª–∏ ¬´–ù–∞—á–∏—Å–ª–µ–Ω–æ¬ª –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–æ 0 ‚Äî –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–∏—Å—Ç ¬´–£—á–∞—Å—Ç–∏–µ¬ª –∏ ¬´–ê–∫—Ç–∏–≤–µ–Ω¬ª –≤ ¬´–°–µ–º—å–∏¬ª
- –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ ¬´—Å–ª–æ–º–∞–ª–æ—Å—å¬ª ‚Äî –∑–∞–ø—É—Å—Ç–∏—Ç–µ Setup / Rebuild structure

## –°—Å—ã–ª–∫–∏
- –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: https://github.com/yobushka/paymentAccountingGoogleSheet

---

## üõ† –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
–ö–æ–¥ —Ä–∞–∑–±–∏—Ç –Ω–∞ 23 –º–æ–¥—É–ª—è –≤ –ø–∞–ø–∫–µ `src/`:

```
src/
‚îú‚îÄ‚îÄ config/           # –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∏ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ª–∏—Å—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ constants.js  # APP_VERSION, ACCRUAL_MODES, SHEET_NAMES
‚îÇ   ‚îî‚îÄ‚îÄ sheets-spec.js
‚îú‚îÄ‚îÄ utils/            # –£—Ç–∏–ª–∏—Ç–∞—Ä–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ utils.js
‚îú‚îÄ‚îÄ calculations/     # –†–∞—Å—á—ë—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ dyn-cap.js    # DYN_CAP() water-filling
‚îÇ   ‚îú‚îÄ‚îÄ custom-functions.js
‚îÇ   ‚îî‚îÄ‚îÄ recalculate.js
‚îú‚îÄ‚îÄ sheets/           # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–∏—Å—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ balance.js, detail.js, summary.js
‚îÇ   ‚îú‚îÄ‚îÄ instruction.js, lists.js
‚îÇ   ‚îî‚îÄ‚îÄ issue-status.js
‚îú‚îÄ‚îÄ core/             # –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ init.js, validations.js
‚îÇ   ‚îú‚îÄ‚îÄ id-generator.js, close-goal.js
‚îÇ   ‚îî‚îÄ‚îÄ sample-data.js
‚îú‚îÄ‚îÄ ui/               # –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å
‚îÇ   ‚îú‚îÄ‚îÄ menu.js, styles.js
‚îÇ   ‚îî‚îÄ‚îÄ dialogs.js
‚îú‚îÄ‚îÄ triggers/         # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ on-edit.js
‚îî‚îÄ‚îÄ migration/        # –ú–∏–≥—Ä–∞—Ü–∏—è v1 ‚Üí v2
    ‚îú‚îÄ‚îÄ detect-version.js
    ‚îî‚îÄ‚îÄ migrate-v1-to-v2.js
```

### –°–±–æ—Ä–∫–∞
```bash
npm run build      # –°–æ–±—Ä–∞—Ç—å Code.gs –∏–∑ –º–æ–¥—É–ª–µ–π
npm run validate   # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –º–æ–¥—É–ª–µ–π
```

–ü–æ—Å–ª–µ —Å–±–æ—Ä–∫–∏ `Code.gs` –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. **–ù–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –µ–≥–æ –Ω–∞–ø—Ä—è–º—É—é** ‚Äî –≤–Ω–æ—Å–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –º–æ–¥—É–ª–∏ –∏ –∑–∞–ø—É—Å–∫–∞–π—Ç–µ `npm run build`.

### –¢–µ—Å—Ç—ã
```bash
npm test           # –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã (vitest)
```

---

## üöÄ CI/CD: –ê–≤—Ç–æ–¥–µ–ø–ª–æ–π –≤ Google Sheets

–ü—Ä–æ–µ–∫—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è –≤ Google Apps Script —á–µ—Ä–µ–∑ GitHub Actions –ø—Ä–∏ push –≤ `main`.

### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

```mermaid
flowchart LR
    A[Push –≤ main] --> B[GitHub Actions]
    B --> C[npm test]
    C --> D[npm run build]
    D --> E[clasp push]
    E --> F[Google Apps Script]
    F --> G[Google Sheets]
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ CI/CD (–ø–æ—à–∞–≥–æ–≤–æ)

#### 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ clasp –ª–æ–∫–∞–ª—å–Ω–æ

```bash
npm install -g @google/clasp
```

#### 2. –ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å –≤ clasp

```bash
clasp login
```

–û—Ç–∫—Ä–æ–µ—Ç—Å—è –±—Ä–∞—É–∑–µ—Ä –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏. –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —Å–æ–∑–¥–∞—Å—Ç—Å—è —Ñ–∞–π–ª `~/.clasprc.json`.

#### 3. –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ–µ–∫—Ç Google Apps Script

**–í–∞—Ä–∏–∞–Ω—Ç A: –ù–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç**
```bash
# –í –ø–∞–ø–∫–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
clasp create --type sheets --title "Payment Accounting"
```

**–í–∞—Ä–∏–∞–Ω—Ç B: –ü—Ä–∏–≤—è–∑–∫–∞ –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É**
```bash
# –û—Ç–∫—Ä–æ–π—Ç–µ Google Sheets ‚Üí –†–∞—Å—à–∏—Ä–µ–Ω–∏—è ‚Üí Apps Script
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ Script ID –∏–∑ URL: https://script.google.com/d/SCRIPT_ID/edit
clasp clone SCRIPT_ID
```

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –ø–æ—è–≤–∏—Ç—Å—è —Ñ–∞–π–ª `.clasp.json` —Å –≤–∞—à–∏–º `scriptId`.

#### 4. –í–∫–ª—é—á–∏—Ç–µ Google Apps Script API

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ [script.google.com/home/usersettings](https://script.google.com/home/usersettings)
2. –í–∫–ª—é—á–∏—Ç–µ **Google Apps Script API**

#### 5. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ GitHub Secrets

–í —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ GitHub –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Settings ‚Üí Secrets and variables ‚Üí Actions** –∏ –¥–æ–±–∞–≤—å—Ç–µ:

| Secret | –û–ø–∏—Å–∞–Ω–∏–µ | –ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å |
|--------|----------|--------------|
| `SCRIPT_ID` | ID –≤–∞—à–µ–≥–æ Apps Script –ø—Ä–æ–µ–∫—Ç–∞ | –ò–∑ —Ñ–∞–π–ª–∞ `.clasp.json` –∏–ª–∏ URL –ø—Ä–æ–µ–∫—Ç–∞ |
| `CLASP_CREDENTIALS` | JSON —Å —Ç–æ–∫–µ–Ω–∞–º–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ | –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ `~/.clasprc.json` |

**–ü–æ–ª—É—á–µ–Ω–∏–µ CLASP_CREDENTIALS:**

```bash
cat ~/.clasprc.json
```

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤–µ—Å—å –≤—ã–≤–æ–¥ (—ç—Ç–æ JSON) –∏ –≤—Å—Ç–∞–≤—å—Ç–µ –∫–∞–∫ –∑–Ω–∞—á–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–∞ `CLASP_CREDENTIALS`.

> ‚ö†Ô∏è **–í–∞–∂–Ω–æ**: –§–∞–π–ª `.clasprc.json` —Å–æ–¥–µ—Ä–∂–∏—Ç refresh token. –•—Ä–∞–Ω–∏—Ç–µ –µ–≥–æ –≤ —Å–µ–∫—Ä–µ—Ç–µ –∏ –Ω–µ –ø—É–±–ª–∏–∫—É–π—Ç–µ!

#### 6. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫—É

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
1. –í–Ω–µ—Å–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤ –ª—é–±–æ–π —Ñ–∞–π–ª –≤ `src/`
2. –°–¥–µ–ª–∞–π—Ç–µ commit –∏ push –≤ `main`
3. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∫–ª–∞–¥–∫—É **Actions** –≤ GitHub ‚Äî –¥–æ–ª–∂–µ–Ω –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è workflow **Deploy to Google Apps Script**
4. –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ—è–≤—è—Ç—Å—è –≤ Google Apps Script

### –†—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π

–ï—Å–ª–∏ CI/CD –Ω–µ –Ω—É–∂–µ–Ω, –º–æ–∂–Ω–æ –¥–µ–ø–ª–æ–∏—Ç—å –≤—Ä—É—á–Ω—É—é:

```bash
# –°–±–æ—Ä–∫–∞
npm run build

# –î–µ–ø–ª–æ–π
clasp push --force
```

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Å clasp

```bash
# –°–∫–∞—á–∞—Ç—å –∫–æ–¥ –∏–∑ Apps Script
clasp pull

# –ó–∞–≥—Ä—É–∑–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
clasp push

# –û—Ç–∫—Ä—ã—Ç—å —Ä–µ–¥–∞–∫—Ç–æ—Ä Apps Script –≤ –±—Ä–∞—É–∑–µ—Ä–µ
clasp open

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
clasp logs
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤ –¥–ª—è clasp

```
.
‚îú‚îÄ‚îÄ .clasp.json        # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞ (scriptId)
‚îú‚îÄ‚îÄ appsscript.json    # –ú–∞–Ω–∏—Ñ–µ—Å—Ç Apps Script
‚îú‚îÄ‚îÄ Code.gs            # –°–æ–±—Ä–∞–Ω–Ω—ã–π –∫–æ–¥ (–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è)
‚îî‚îÄ‚îÄ src/               # –ò—Å—Ö–æ–¥–Ω—ã–µ –º–æ–¥—É–ª–∏
```

### Troubleshooting

**–û—à–∏–±–∫–∞ "Script API not enabled"**
- –í–∫–ª—é—á–∏—Ç–µ API: [script.google.com/home/usersettings](https://script.google.com/home/usersettings)

**–û—à–∏–±–∫–∞ "Invalid Credentials"**
- –ü–µ—Ä–µ–∑–∞–π–¥–∏—Ç–µ: `clasp logout && clasp login`
- –û–±–Ω–æ–≤–∏—Ç–µ —Å–µ–∫—Ä–µ—Ç `CLASP_CREDENTIALS`

**–û—à–∏–±–∫–∞ "Script not found"**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `SCRIPT_ID` ‚Äî –æ–Ω –¥–æ–ª–∂–µ–Ω —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å ID –≤ URL –ø—Ä–æ–µ–∫—Ç–∞

**Push –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç**
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `appsscript.json` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –ø—Ä–æ–µ–∫—Ç—É

---

## Disclaimer
- –≠—Ç–æ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –≤ –≤–µ—Ä—Å–∏–∏ 2.0 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ª–∏—á–Ω—ã—Ö —Ü–µ–ª–µ–π. Contribution & feedback welcome.
- –°–ª–µ–¥–∏—Ç–µ –∑–∞ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö: –ø–µ—Ä–µ–¥–∞—á–∞ –ü–î–Ω –∑–∞ –ø—Ä–µ–¥–µ–ª—ã –≤–∞—à–µ–π —é—Ä–∏—Å–¥–∏–∫—Ü–∏–∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–∑–∞–∫–æ–Ω–Ω–æ–π. Google (–∏ Google Sheets) ‚Äî –∏–Ω–æ—Å—Ç—Ä–∞–Ω–Ω–∞—è –∫–æ–º–ø–∞–Ω–∏—è; —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã —Å–æ–±–ª—é–¥–∞–µ—Ç–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ–µ –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–æ –∏ –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø–æ–ª–∏—Ç–∏–∫–∏.

## –õ–∏—Ü–µ–Ω–∑–∏—è
–ö–æ–¥ –ø—É–±–ª–∏–∫—É–µ—Ç—Å—è –∫–∞–∫ –µ—Å—Ç—å –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤–Ω—É—Ç—Ä–∏ –≤–∞—à–µ–π —Ç–∞–±–ª–∏—Ü—ã. –í–Ω–µ—à–Ω–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ –Ω–µ—Ç; —Ç–æ–ª—å–∫–æ Google Apps Script API.
