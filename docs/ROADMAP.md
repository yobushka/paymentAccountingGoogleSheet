# Roadmap v2.0 ‚Äî –ß–µ–∫–ª–∏—Å—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

> –î–µ—Ç–∞–ª—å–Ω–∞—è –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è –∑–∞–¥–∞—á –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã —É—á—ë—Ç–∞ –¥–æ –≤–µ—Ä—Å–∏–∏ 2.0 (–±–∞–ª–∞–Ω—Å–æ–≤–∞—è –º–æ–¥–µ–ª—å)
> 
> **–û–±–Ω–æ–≤–ª–µ–Ω–æ: 2025-12-11**

---

## –û–±–∑–æ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π

| –ê—Å–ø–µ–∫—Ç | v1.x | v2.0 |
|--------|------|------|
| –ü–ª–∞—Ç—ë–∂ | –ü—Ä–∏–≤—è–∑–∞–Ω –∫ —Å–±–æ—Ä—É | –°–≤–æ–±–æ–¥–Ω—ã–π –∏–ª–∏ —Ü–µ–ª–µ–≤–æ–π |
| ID —Å–±–æ—Ä–æ–≤ | `collection_id` (C001) | `goal_id` (G001) |
| –ë–∞–ª–∞–Ω—Å | –û–ø–ª–∞—á–µ–Ω–æ ‚àí –ù–∞—á–∏—Å–ª–µ–Ω–æ | –í–Ω–µ—Å–µ–Ω–æ ‚àí –°–ø–∏—Å–∞–Ω–æ ‚àí –†–µ–∑–µ—Ä–≤ |
| –õ–∏—Å—Ç —Å–±–æ—Ä–æ–≤ | ¬´–°–±–æ—Ä—ã¬ª | ¬´–¶–µ–ª–∏¬ª |

---

## –§–∞–∑–∞ 1: –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö ‚úÖ

### 1. –û–±–Ω–æ–≤–∏—Ç—å `getSheetsSpec()` ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ª–∏—Å—Ç–æ–≤ v2 ‚úÖ

- [x] 1.1 –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é `–°–±–æ—Ä—ã` ‚Üí `–¶–µ–ª–∏`
- [x] 1.2 –û–±–Ω–æ–≤–∏—Ç—å headers –¥–ª—è –ª–∏—Å—Ç–∞ `–¶–µ–ª–∏` (goal_id, –¢–∏–ø, –ü–µ—Ä–∏–æ–¥–∏—á–Ω–æ—Å—Ç—å, –†–æ–¥–∏—Ç–µ–ª—å—Å–∫–∞—è —Ü–µ–ª—å)
- [x] 1.3 –û–±–Ω–æ–≤–∏—Ç—å `colWidths` –¥–ª—è –Ω–æ–≤—ã—Ö –∫–æ–ª–æ–Ω–æ–∫
- [x] 1.4 –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é –ª–∏—Å—Ç–∞ `–ë–∞–ª–∞–Ω—Å` (–í–Ω–µ—Å–µ–Ω–æ, –°–ø–∏—Å–∞–Ω–æ, –†–µ–∑–µ—Ä–≤, –°–≤–æ–±–æ–¥–Ω–æ, –î–æ–ª–≥)
- [x] 1.5‚Äì1.10 –û–±–Ω–æ–≤–∏—Ç—å –£—á–∞—Å—Ç–∏–µ, –ü–ª–∞—Ç–µ–∂–∏, –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è, –°–≤–æ–¥–∫–∞, Lists, –í—ã–¥–∞—á–∞

---

### 2. –°–æ–∑–¥–∞—Ç—å –ª–∏—Å—Ç ¬´–¶–µ–ª–∏¬ª –≤–º–µ—Å—Ç–æ ¬´–°–±–æ—Ä—ã¬ª ‚úÖ

- [x] 2.1 –í `init()` —Å–æ–∑–¥–∞–≤–∞—Ç—å –ª–∏—Å—Ç `–¶–µ–ª–∏` (—Å `detectVersion()`)
- [x] 2.2 –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ —Å—Å—ã–ª–∫–∏ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `detectVersion()` –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)
- [x] 2.3‚Äì2.6 –í—ã–ø–∞–¥–∞—é—â–∏–µ —Å–ø–∏—Å–∫–∏ –∏ —Å—Ç–∞—Ç—É—Å—ã v2

---

### 3. –û–±–Ω–æ–≤–∏—Ç—å –ª–∏—Å—Ç ¬´–ü–ª–∞—Ç–µ–∂–∏¬ª ‚Äî goal_id –æ–ø—Ü–∏–æ–Ω–∞–ª–µ–Ω ‚úÖ

- [x] 3.1 –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫ `collection_id (label)` ‚Üí `goal_id (label)`
- [x] **3.2 –†–∞–∑—Ä–µ—à–∏—Ç—å –ø—É—Å—Ç–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ goal_id –≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏** ‚úÖ
- [x] 3.3 –°–≤–æ–±–æ–¥–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏ ‚úÖ
- [x] 3.4‚Äì3.5 PAYED_TOTAL_FAMILY –∏ onEdit –æ–±–Ω–æ–≤–ª–µ–Ω—ã

---

### 4. –û–±–Ω–æ–≤–∏—Ç—å –ª–∏—Å—Ç ¬´–ë–∞–ª–∞–Ω—Å¬ª ‚Äî –Ω–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ v2 ‚úÖ

- [x] 4.1‚Äì4.3 –ó–∞–≥–æ–ª–æ–≤–∫–∏, colWidths, styleBalanceSheet_()

---

## –§–∞–∑–∞ 2: –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ ‚úÖ

### 5. –î–æ–±–∞–≤–∏—Ç—å —Ä–µ–∂–∏–º ¬´voluntary¬ª ‚úÖ

- [x] 5.1‚Äì5.2 `voluntary` –≤ constants.js –∏ rebuildValidations()
- [x] **5.3 –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `voluntary` –≤ `calculateAccrual_()`** ‚úÖ
- [x] 5.4‚Äì5.5 –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤ GENERATE_DETAIL –∏ GENERATE_SUMMARY
- [x] 5.6 –û–ø–∏—Å–∞–Ω–∏–µ –≤ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** `voluntary` –±—ã–ª —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≤ `src/sheets/detail.js` (—Å—Ç—Ä–æ–∫–∏ 380-382)

---

### 6. –û–±–Ω–æ–≤–∏—Ç—å `setupListsSheet()` ‚Äî named ranges v2 ‚úÖ

- [x] 6.1‚Äì6.5 –í—Å—ë —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π v1/v2

---

### 7. –û–±–Ω–æ–≤–∏—Ç—å `rebuildValidations()` ‚Äî goal_id ‚úÖ

- [x] 7.1‚Äì7.5 –í—Å–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã

---

### 8. –ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å `ACCRUED_FAMILY()` ‚Üí v2 –ª–æ–≥–∏–∫–∞ ‚úÖ

- [x] 8.1 –ü–æ–¥–¥–µ—Ä–∂–∫–∞ OPEN/ALL —á–µ—Ä–µ–∑ statusFilter
- [x] **8.2 –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è RESERVED/CHARGED** ‚úÖ (OPEN/CLOSED/ALL)
- [x] **8.3 –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∂–∏–º–∞ `voluntary`** ‚úÖ
- [x] 8.4‚Äì8.5 –°—Å—ã–ª–∫–∏ –∏ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

---

## –§–∞–∑–∞ 3: –†–∞—Å—á—ë—Ç—ã –∏ —Ñ–æ—Ä–º—É–ª—ã ‚úÖ

### 9. –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –∫–∞—Å—Ç–æ–º–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ v2 ‚úÖ

- [x] 9.1 `PAYED_TOTAL_FAMILY` ‚Äî —É–∂–µ –µ—Å—Ç—å
- [x] **9.2 `TOTAL_CHARGED_FAMILY(familyId)`** ‚úÖ ‚Äî –∑–∞–∫—Ä—ã—Ç—ã–µ —Ü–µ–ª–∏
- [x] **9.3 `RESERVED_FAMILY(familyId)`** ‚úÖ ‚Äî –æ—Ç–∫—Ä—ã—Ç—ã–µ —Ü–µ–ª–∏
- [x] **9.4 `BALANCE_FAMILY(familyId)`** ‚úÖ ‚Äî –í–Ω–µ—Å–µ–Ω–æ ‚àí –°–ø–∏—Å–∞–Ω–æ
- [x] **9.5 `FREE_BALANCE_FAMILY(familyId)`** ‚úÖ ‚Äî –ë–∞–ª–∞–Ω—Å ‚àí –†–µ–∑–µ—Ä–≤
- [x] **9.6 `DEBT_FAMILY(familyId)`** ‚úÖ ‚Äî MAX(0, ‚àí–°–≤–æ–±–æ–¥–Ω–æ)
- [x] **9.7 `PAID_TO_GOAL(familyId, goalId)`** ‚úÖ
- [x] **9.8 `ACCRUED_FOR_GOAL(familyId, goalId)`** ‚úÖ
- [x] **9.9 `BALANCE_FOR_GOAL(familyId, goalId)`** ‚úÖ ‚Äî –±–æ–Ω—É—Å
- [x] **9.10 `FREE_PAYMENTS_FAMILY(familyId)`** ‚úÖ ‚Äî —Å–≤–æ–±–æ–¥–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏

---

### 10. –û–±–Ω–æ–≤–∏—Ç—å `refreshBalanceFormulas_()` ‚Äî v2 ‚úÖ

- [x] 10.1‚Äì10.6 –í—Å–µ —Ñ–æ—Ä–º—É–ª—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã

---

### 11‚Äì12. Detail –∏ Summary ‚úÖ

- [x] –ë–∞–∑–æ–≤–∞—è —Ä–∞–±–æ—Ç–∞ —Å goal_id
- [x] **–û–±—Ä–∞–±–æ—Ç–∫–∞ `voluntary`** ‚úÖ
- [x] **–û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–≤–æ–±–æ–¥–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π** ‚úÖ
- [x] **–û–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ `–û—Ç–º–µ–Ω–µ–Ω–∞`** ‚úÖ

---

## –§–∞–∑–∞ 4: –ú–∏–≥—Ä–∞—Ü–∏—è –∏ UI ‚úÖ

### 13. –ú–∏–≥—Ä–∞—Ü–∏—è v1‚Üív2 ‚úÖ

- [x] 13.1‚Äì13.5 –û—Å–Ω–æ–≤–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç
- [x] 13.7 –ë–∞–∑–æ–≤–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
- [x] 13.9‚Äì13.10 –û—Ç–∫–∞—Ç –∏ entry point
- [x] 13.8 showMigrationReport_() ‚úÖ
- [x] 13.11 cleanupBackups_() ‚úÖ

---

### 14‚Äì16. –ú–µ–Ω—é, –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è, SampleData ‚úÖ

- [x] –í—Å—ë —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

---

## –§–∞–∑–∞ 5: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ ‚úÖ

### 17. –¢–µ—Å—Ç—ã

- [x] 17.1 –¢–µ—Å—Ç—ã pure.js —Ä–∞–±–æ—Ç–∞—é—Ç ‚úÖ
- [x] 17.2 appscript-usage —Ç–µ—Å—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç ‚úÖ

---

## üìä –°–≤–æ–¥–∫–∞

| –§–∞–∑–∞ | –°—Ç–∞—Ç—É—Å | –ü—Ä–æ–≥—Ä–µ—Å—Å |
|------|--------|----------|
| –§–∞–∑–∞ 1: –°—Ç—Ä—É–∫—Ç—É—Ä–∞ | ‚úÖ | 100% |
| –§–∞–∑–∞ 2: –õ–æ–≥–∏–∫–∞ | ‚úÖ | 100% |
| –§–∞–∑–∞ 3: –§–æ—Ä–º—É–ª—ã | ‚úÖ | 100% |
| –§–∞–∑–∞ 4: UI | ‚úÖ | 100% |
| –§–∞–∑–∞ 5: –¢–µ—Å—Ç—ã | ‚úÖ | 100% |

**üéâ –í—Å–µ –∑–∞–¥–∞—á–∏ ROADMAP v2.0 –≤—ã–ø–æ–ª–Ω–µ–Ω—ã!**

---

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é

### 2025-12-11:
- ‚úÖ –†–µ–∂–∏–º `voluntary` ‚Äî **—É–∂–µ –±—ã–ª —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω** –≤ `calculateAccrual_()`
- ‚úÖ –ù–æ–≤—ã–µ –∫–∞—Å—Ç–æ–º–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ v2:
  - `TOTAL_CHARGED_FAMILY` ‚Äî —Å–ø–∏—Å–∞–Ω–∏—è (–∑–∞–∫—Ä—ã—Ç—ã–µ —Ü–µ–ª–∏)
  - `RESERVED_FAMILY` ‚Äî —Ä–µ–∑–µ—Ä–≤—ã (–æ—Ç–∫—Ä—ã—Ç—ã–µ —Ü–µ–ª–∏)
  - `BALANCE_FAMILY` ‚Äî —Ç–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å
  - `FREE_BALANCE_FAMILY` ‚Äî —Å–≤–æ–±–æ–¥–Ω—ã–π –æ—Å—Ç–∞—Ç–æ–∫
  - `DEBT_FAMILY` ‚Äî –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç—å
  - `PAID_TO_GOAL` ‚Äî –ø–ª–∞—Ç–µ–∂–∏ –ø–æ —Ü–µ–ª–∏
  - `ACCRUED_FOR_GOAL` ‚Äî –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ –ø–æ —Ü–µ–ª–∏
  - `BALANCE_FOR_GOAL` ‚Äî —Å–∞–ª—å–¥–æ –ø–æ —Ü–µ–ª–∏
  - `FREE_PAYMENTS_FAMILY` ‚Äî —Å–≤–æ–±–æ–¥–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏
- ‚úÖ `readGoals_()` —Ç–µ–ø–µ—Ä—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç OPEN/CLOSED/ALL —Ñ–∏–ª—å—Ç—Ä—ã
- ‚úÖ `ACCRUED_FAMILY()` –∏ `ACCRUED_BREAKDOWN()` –æ–±–Ω–æ–≤–ª–µ–Ω—ã
- ‚úÖ –¢–µ—Å—Ç—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã (10/10 –ø—Ä–æ—Ö–æ–¥—è—Ç)

### 2025-12-11 (–ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ):
- ‚úÖ –ü–æ–ª—è ¬´–ß–ª–µ–Ω—Å—Ç–≤–æ —Å¬ª –∏ ¬´–ß–ª–µ–Ω—Å—Ç–≤–æ –ø–æ¬ª –¥–ª—è —Å–µ–º–µ–π
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –∏–∑ —Ü–µ–ª–µ–π –ø–æ –ø–µ—Ä–∏–æ–¥—É —á–ª–µ–Ω—Å—Ç–≤–∞
- ‚úÖ –ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏: EXIT_BALANCE, MEMBERSHIP_MONTHS, MEMBERSHIP_RATIO, IS_MEMBER_ON_DATE
- ‚úÖ goal_id –æ–ø—Ü–∏–æ–Ω–∞–ª–µ–Ω –≤ –ü–ª–∞—Ç–µ–∂–∞—Ö (—Å–≤–æ–±–æ–¥–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏)
- ‚úÖ –°–≤–æ–±–æ–¥–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏
- ‚úÖ –°—Ç–∞—Ç—É—Å ¬´–û—Ç–º–µ–Ω–µ–Ω–∞¬ª –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è –≤ —Ä–∞—Å—á—ë—Ç–∞—Ö
- ‚úÖ showMigrationReport_() ‚Äî –æ—Ç—á—ë—Ç –æ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –∏ –±—ç–∫–∞–ø–∞—Ö
- ‚úÖ cleanupBackups_() ‚Äî –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –±—ç–∫–∞–ø–æ–≤ —Å –¥–∏–∞–ª–æ–≥–æ–º
- ‚úÖ –ù–æ–≤—ã–µ –ø—É–Ω–∫—Ç—ã –º–µ–Ω—é: Migration Report, Cleanup old backups

---

*‚úÖ ROADMAP v2.0 –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–≤–µ—Ä—à—ë–Ω ‚Äî 2025-12-11*
